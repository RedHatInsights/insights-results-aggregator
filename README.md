# Insights Results Aggregator

[![forthebadge made-with-go](http://ForTheBadge.com/images/badges/made-with-go.svg)](https://go.dev/)

[![GoDoc](https://godoc.org/github.com/RedHatInsights/insights-results-aggregator?status.svg)](https://godoc.org/github.com/RedHatInsights/insights-results-aggregator)
[![GitHub Pages](https://img.shields.io/badge/%20-GitHub%20Pages-informational)](https://redhatinsights.github.io/insights-results-aggregator/)
[![Go Report Card](https://goreportcard.com/badge/github.com/RedHatInsights/insights-results-aggregator)](https://goreportcard.com/report/github.com/RedHatInsights/insights-results-aggregator)
[![Build Status](https://ci.ext.devshift.net/buildStatus/icon?job=RedHatInsights-insights-results-aggregator-gh-build-master)](https://ci.ext.devshift.net/job/RedHatInsights-insights-results-aggregator-gh-build-master/)
[![Build Status](https://travis-ci.org/RedHatInsights/insights-results-aggregator.svg?branch=master)](https://travis-ci.org/RedHatInsights/insights-results-aggregator)
[![codecov](https://codecov.io/gh/RedHatInsights/insights-results-aggregator/branch/master/graph/badge.svg)](https://codecov.io/gh/RedHatInsights/insights-results-aggregator)
![GitHub go.mod Go version](https://img.shields.io/github/go-mod/go-version/RedHatInsights/insights-results-aggregator)
[![License](https://img.shields.io/badge/license-Apache-blue)](https://github.com/RedHatInsights/insights-results-aggregator/blob/master/LICENSE)

Aggregator service for insights results

<!-- vim-markdown-toc GFM -->

* [Description](#description)
* [Documentation](#documentation)
* [Makefile targets](#makefile-targets)
* [BDD tests](#bdd-tests)
* [Package manifest](#package-manifest)

<!-- vim-markdown-toc -->


## Description

Insights Results Aggregator is a service that provides Insight OCP data
(officially called *recommendations*) that are being consumed by OpenShift
Cluster Manager (OCM), Advanced Cluster Manager (ACM), and OCP WebConsole via
Insights Operator. That data contain information about clusters status
(especially health, security, performance, etc.) and recommendations based on
results generated by Insights rules engine. Insights OCP data are consumed from
selected broker, stored in different storages (that basically work as a cache)
so we can expose it via REST API endpoints.

## Documentation

Documentation is hosted on Github Pages <https://redhatinsights.github.io/insights-results-aggregator/>.
Sources are located in [docs](https://github.com/RedHatInsights/insights-results-aggregator/tree/master/docs).

## Makefile targets

```
clean                Run go clean
build                Build binary containing service executable
build-cover          Build binary with code coverage detection support
fmt                  Run go fmt -w for all sources
lint                 Run golint
vet                  Run go vet. Report likely mistakes in source code
cyclo                Run gocyclo
ineffassign          Run ineffassign checker
shellcheck           Run shellcheck
errcheck             Run errcheck
goconst              Run goconst checker
gosec                Run gosec checker
abcgo                Run ABC metrics checker
json-check           Check all JSONs for basic syntax
style                Run all the formatting related commands (fmt, vet, lint, cyclo) + check shell scripts
run                  Build the project and executes the binary
test                 Run the unit tests
cover                Generate HTML pages with code coverage
coverage             Display code coverage on terminal
integration_tests    Run all integration tests
rest_api_tests       Run REST API tests
before_commit        Checks done before commit
help                 Show this help screen
function_list        List all functions in generated binary file
```

## BDD tests

Behaviour tests for this service are included in [Insights Behavioral
Spec](https://github.com/RedHatInsights/insights-behavioral-spec) repository.
In order to run these tests, the following steps need to be made:

1. clone the [Insights Behavioral Spec](https://github.com/RedHatInsights/insights-behavioral-spec) repository
1. go into the cloned subdirectory `insights-behavioral-spec`
1. run the `insights_results_aggregator_tests.sh` from this subdirectory

List of all test scenarios prepared for this service is available at
<https://redhatinsights.github.io/insights-behavioral-spec/feature_list.html#insights-results-aggregator>


## Package manifest

Package manifest is available at [docs/manifest.txt](docs/manifest.txt).
